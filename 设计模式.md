## 单例模式

1. 饿汉式

   ```java
   package 单例模式;
   
   import java.util.concurrent.atomic.AtomicLong;
   
   public class 单例_饿汉式 {
   
       //类加载时创建好实例
       private static final 单例_饿汉式 instance = new 单例_饿汉式();
   
       //构造私有化
       private 单例_饿汉式() {
       }
   
       //提供获取实例方法
       public static 单例_饿汉式 getInstance() {
           return instance;
       }
   
       private AtomicLong id = new AtomicLong(0);
   
       public long getId() {
           return id.incrementAndGet();
       }
   }
   
   ```

   

2. 懒汉式

   ```JAVA
   package 单例模式;
   
   import java.util.concurrent.atomic.AtomicLong;
   
   public class 单例_懒汉式 {
       //支持延迟加载
       private static 单例_懒汉式 instance;
   
       //构造私有化
       private 单例_懒汉式() {
       }
   
       //提供获取实例方法 synchronized锁
       public static synchronized 单例_懒汉式 getInstance() {
           if (instance == null) {
               instance = new 单例_懒汉式();
           }
           return instance;
       }
   
       private AtomicLong id = new AtomicLong(0);
   
       public long getId() {
           return id.incrementAndGet();
       }
   }
   
   ```

   

3. 双重检测

   ```java
   package 单例模式;
   
   import java.util.concurrent.atomic.AtomicLong;
   
   public class 单例_双重检测 {
       //支持延迟加载
       private static 单例_双重检测 instance;
   
       //构造私有化
       private 单例_双重检测() {
       }
   
       //提供获取实例方法 类级别的锁
       public static 单例_双重检测 getInstance() {
           if (instance == null) {
               synchronized (单例_双重检测.class) { // 此处为类级别的锁
                   if (instance == null) {
                       instance = new 单例_双重检测();
                   }
               }
           }
           return instance;
       }
   
       private AtomicLong id = new AtomicLong(0);
   
       public long getId() {
           return id.incrementAndGet();
       }
   }
   
   ```

   

4. 静态内部类

   ```java
   package 单例模式;
   
   import java.util.concurrent.atomic.AtomicLong;
   
   public class 单例_静态内部类 {
       //支持延迟加载
   
       //构造私有化
       private 单例_静态内部类() {
       }
   
       //静态内部类
       public static class SingletonHolder {
           private static final 单例_静态内部类 instance = new 单例_静态内部类();
       }
   
       //提供获取实例方法
       public static 单例_静态内部类 getInstance() {
           return SingletonHolder.instance;
       }
   
       private AtomicLong id = new AtomicLong(0);
   
       public long getId() {
           return id.incrementAndGet();
       }
   }
   
   ```

   

5. 枚举

   ```java
   package 单例模式;
   
   import java.util.concurrent.atomic.AtomicLong;
   
   public enum 单例_枚举 {
   
       INSTANCE;
   
       private AtomicLong id = new AtomicLong(0);
   
       public long getId() {
           return id.incrementAndGet();
       }
   }
   
   ```

   

## 工厂模式

1. 简单工厂

   ```java
   package 工厂模式;
   
   import 工厂模式.phone.HuaWeiPhone;
   import 工厂模式.phone.IPhone;
   import 工厂模式.phone.Phone;
   
   public class 简单工厂 {
       public static void main(String[] args) {
           simpleFactory simpleFactory = new simpleFactory();
           Phone phone = simpleFactory.create("apple");
           phone.print();
           Phone phone2 = simpleFactory.create("huawei");
           phone2.print();
       }
   }
   
   class simpleFactory {
       public Phone create(String type) {
           if (type.equals("apple")) {
               return new IPhone();
           } else if (type.equals("huawei")) {
               return new HuaWeiPhone();
           } else {
               throw new RuntimeException("No Such Type !");
           }
       }
   }
   
   
   ```

   

2. 工厂模式

   ```java
   package 工厂模式;
   
   import 工厂模式.phone.HuaWeiPhone;
   import 工厂模式.phone.IPhone;
   import 工厂模式.phone.Phone;
   
   import java.util.HashMap;
   import java.util.Map;
   
   public class 工厂模式 {
       public static void main(String[] args) {
           PhoneFactory apple = PhoneFactoryPattern.getPhoneFactory("apple");
           apple.create().print();
       }
   }
   
   //创建工厂的工厂
   class PhoneFactoryPattern {
       private static final Map<String, PhoneFactory> PHONE_FACTORY_MAP = new HashMap<>();
   
       static {
           PHONE_FACTORY_MAP.put("apple", new IPhoneFactory());
           PHONE_FACTORY_MAP.put("huawei", new HuaWeiPhoneFactory());
       }
   
       public static PhoneFactory getPhoneFactory(String type) {
           if (type == null || type.isEmpty()) {
               return null;
           }
           return PHONE_FACTORY_MAP.get(type);
       }
   }
   
   abstract class PhoneFactory {
       public abstract Phone create();
   }
   
   class IPhoneFactory extends PhoneFactory {
   
       @Override
       public Phone create() {
           return new IPhone();
       }
   }
   
   class HuaWeiPhoneFactory extends PhoneFactory {
   
       @Override
       public Phone create() {
           return new HuaWeiPhone();
       }
   }
   
   ```

   

3. 抽象工厂

   ```java
   package 工厂模式;
   
   import 工厂模式.Mask.KN90;
   import 工厂模式.Mask.Mask;
   import 工厂模式.Mask.N95;
   import 工厂模式.phone.HuaWeiPhone;
   import 工厂模式.phone.IPhone;
   import 工厂模式.phone.Phone;
   
   import java.util.HashMap;
   import java.util.Map;
   
   public class 抽象工厂 {
       public static void main(String[] args) {
           Factory factory = FactoryPattern.getFactory("KN90");
           factory.createMask().print();
       }
   }
   
   //创建工厂的工厂
   class FactoryPattern {
       private static final Map<String, Factory> PHONE_FACTORY_MAP = new HashMap<>();
   
       static {
           FactoryA factoryA = new FactoryA();
           PHONE_FACTORY_MAP.put("apple", factoryA);
           PHONE_FACTORY_MAP.put("N95", factoryA);
           FactoryB factoryB = new FactoryB();
           PHONE_FACTORY_MAP.put("huawei", factoryB);
           PHONE_FACTORY_MAP.put("KN90", factoryB);
       }
   
       public static Factory getFactory(String type) {
           if (type == null || type.isEmpty()) {
               return null;
           }
           return PHONE_FACTORY_MAP.get(type);
       }
   }
   
   //可以生成多种产品的抽象工厂
   abstract class Factory {
       public abstract Phone createPhone();
       public abstract Mask createMask();
   }
   
   class FactoryA extends Factory {
   
       @Override
       public Phone createPhone() {
           return new IPhone();
       }
       @Override
       public Mask createMask() {
           return new N95();
       }
   }
   
   class FactoryB extends Factory {
   
       @Override
       public Phone createPhone() {
           return new HuaWeiPhone();
       }
       @Override
       public Mask createMask() {
           return new KN90();
       }
   }
   
   ```

   
